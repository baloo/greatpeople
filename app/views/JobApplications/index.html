#{extends 'main.html' /}
#{set title:'Resume' /}
#{set 'moreScripts'}
<script src="@{'/public/javascripts/lib/jquery.jeditable.mini.js'}" type="text/javascript" charset="utf-8"></script>
#{/set}
#{set 'nav'}
            <nav>
                <ul>
                    <li class="new"><a href="@{Application.box('new')}">Submited</a></li>
                    <li class="inprogress"><a href="@{Application.box('inprogress')}">In process</a></li>
                    <li class="archived"><a href="@{Application.box('archived')}">Archived</a></li>
                </ul>
            </nav>
#{/}
<div id="candidate">
    <h1 class="inplace" id="name">${resume.name}</h1>
    <dl class="contact">
        <dt>Contact</dt>
        <dd><span class="type">Phone:</span><span id="phone" class="inplace">${resume.phone}</span></dd>
        <dd><span class="type">Mail:</span><span id="email" class="inplace">${resume.email}</span></dd>
    </dl>
    <dl class="contact">
        <dt>Meta</dt>
        <dd><span class="type">Submitted:</span>${resume.submitted}</dd>

    </dl>

    <div class="original-message">
        <pre>${resume.message}</pre>
    </div>
    <div class="tags" style="display:none">
        <ul>
            <li>Developer</li>
            <li>Python</li>
            <li>Javascript</li>
        </ul>
        <input type="text" id="addTag" placeholder="Add a tag" />
    </div>
    <div class="tags">
        Comments:<br/>
        #{list resume.notes}
            <pre>${_.comment} - ${_.name} - Rating: ${_.rating}</pre>
        #{/}
    </div>
    <div>
        #{form @JobApplications.postNote(resume.id)}
            <p>
                <label for="content">Comment: </label>
                <textarea name="comment" id="comment"></textarea>
            </p>
            <p>
                <label for="rating">Rating: </label>
                <select id="rating">
                    <option value="0" selected>no rating</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </p>
            <p>
                <input type="submit" value="Submit your comment" />
            </p>
        #{/form}
    </div>
    
    <div>
        #{form @JobApplications.sendMessage(resume.id)}
            <span style="color:#c00">Your message will be send!</span>
            <p>
                <label for="content">Comment: </label>
                <textarea name="comment" id="comment"></textarea>
            </p>
            <p>
                <input type="submit" value="Send this message" />
            </p>
        #{/form}
    </div>
    
</div>

<script>
$(function(){
    $(".inplace").editable("@{change()}", {
        tooltip: 'Click to edit',
        attribute: this.id,
        style: 'display: inline',
        submitdata : {resumeId: "${resume.id}"}
    });
});
</script>
